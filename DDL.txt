CREATE OR REPLACE TABLE T_SALES_ORDER_HEADER (
	Order_ID VARCHAR(10),
	Order_DATE DATE,
	STATUS VARCHAR(10),
	CUSTOMER_ID VARCHAR(10),
	ITEM_COUNT INTEGER,
	TOTAL_AMOUNT NUMBER(12,2),
	DISCOUNT NUMBER(10,2),
	CREATE_DATE DATE,
	CREATE_USER VARCHAR(10)
    )

CREATE OR REPLACE TABLE T_SALES_ORDER_DETAIL (
	ORDER_ID VARCHAR(10),
	ORDER_DATE DATE,
	CUSTOMER_ID VARCHAR(10),
	ITEM_ID VARCHAR(10),
	QTY INTEGER,
    PRICE NUMBER(12,2),
	TOTAL_AMOUNT NUMBER(12,2),
	CREATE_DATE DATE,
	CREATE_USER VARCHAR(10)
)

CREATE OR REPLACE TABLE T_CUSTOMER (
	CUSTOMER_ID VARCHAR(10),
	ADDRESS VARCHAR(50),
	PHONE_NO VARCHAR(10),
	CATEGORY VARCHAR(10),
	STATUS VARCHAR(10),
	TOTAL_ORDERS INTEGER,
	TOTAL_INVOICE_AMOUNT NUMBER(12,2),
	LOYALTY_POINTS NUMBER(12,2),
	CREATE_DATE DATE,
	CREATE_USER VARCHAR(10)
)

CREATE OR REPLACE TABLE T_PROMOTION(
	PROMOTION_ID VARCHAR(10),
	CUSTOMER_CATEGORY VARCHAR(10),
	PROMOTION_TYPE VARCHAR(10),
	PROMOTION_VALUE NUMBER(10,2),
	COMMENT VARCHAR(20)
)

CREATE OR REPLACE TABLE T_INVOICE(
	ORDER_ID VARCHAR(10),
	ORDER_DATE DATE,
	INVOICE_DATE DATE,
	TAX_AMOUNT NUMBER(10,2),
	TOTAL_AMOUNT NUMBER(12,2),
	DISCOUNT NUMBER(10,2),
	FINAL_INVOICE_AMT NUMBER(12,2),
	CUSTOMER_ID VARCHAR(10),
	CREATE_DATE DATE,
	CREATE_USER VARCHAR(10)
)
DROP TABLE TASK1_PUCHASEORDER.ORDER_BASE.V_PROMOTION;
===========================================================================================

CREATE OR REPLACE VIEW TASK1_PURCHASEORDER.ORDER_XFRM.V_SALES_ORDER_HEADER (
	ORDER_ID,
	ORDER_DATE,
	STATUS,
	CUSTOMER_ID,
	ITEM_COUNT,
	TOTAL_AMOUNT,
	DISCOUNT,
	CREATE_DATE,
	CREATE_USER,
    COUPON_CODE
) AS SELECT * FROM TASK1_PURCHASEORDER."ORDER _BASE".T_SALES_ORDER_HEADER;

    CREATE OR REPLACE VIEW TASK1_PURCHASEORDER.ORDER_XFRM.V_SALES_ORDER_DETAIL (
	ORDER_ID,
	ORDER_DATE,
	CUSTOMER_ID,
	ITEM_ID,
	QTY,
    PRICE,
	TOTAL_AMOUNT,
	CREATE_DATE,
	CREATE_USER
) AS SELECT * FROM TASK1_PURCHASEORDER."ORDER _BASE".T_SALES_ORDER_DETAIL;

CREATE OR REPLACE VIEW TASK1_PURCHASEORDER.ORDER_XFRM.V_CUSTOMER (
	CUSTOMER_ID,
	ADDRESS,
	PHONE_NO,
	CATEGORY,
	STATUS,
	TOTAL_ORDERS,
	TOTAL_INVOICE_AMOUNT,
	LOYALITY_POINTS,
	CREATE_DATE,
	CREATE_USER
) AS SELECT * FROM TASK1_PURCHASEORDER."ORDER _BASE".T_CUSTOMER;

CREATE OR REPLACE VIEW TASK1_PURCHASEORDER.ORDER_XFRM.V_PROMOTION(
	PROMOTION_ID,
	CUSTOMER_CATEGORY,
	PROMOTION_TYPE,
	PROMOTION_VALUE,
	COMMENT
) AS SELECT * FROM TASK1_PURCHASEORDER."ORDER _BASE".T_PROMOTION;

create or replace view TASK1_PURCHASEORDER.ORDER_XFRM.V_INVOICE(
    ORDER_ID,
    ORDER_DATE,
    INVOICE_DATE,
    TAX_AMOUNT,
    TOTAL_AMOUNT,
    DISCOUNT,
    FINAL_INVOICE_AMT,
    CUSTOMER_ID,
    CREATE_DATE,
    CREATE_USER
) as SELECT * FROM TASK1_PURCHASEORDER.ORDER_BASE.T_INVOICE;